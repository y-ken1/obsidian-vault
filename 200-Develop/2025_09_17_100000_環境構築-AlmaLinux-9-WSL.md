# 2025_09_17_100000_環境構築-AlmaLinux-9-WSL

## AlmaLinux 9 のダウンロードからインストールまで

1. 管理者権限で PowerShell を開く
1. 適当なフォルダに移動（~/download/almalinux/など
1. AlmaLinux 9 のインストール

   Intel/AMD (x86_64)の場合

   ```bash
   Invoke-WebRequest -Uri https://wsl.almalinux.org/9/AlmaLinuxOS-9_latest_x64.appx -OutFile AlmaLinuxOS-9.appx -UseBasicParsing
   ```

1. ZIP 化、展開

   ```bash
   move .\AlmaLinuxOS-9.appx .\AlmaLinuxOS-9.zip; Expand-Archive .\AlmaLinuxOS-9.zip
   ```

1. インストール

   ```bash
   cd AlmaLinuxOS-9; mkdir -p 'C:\wsl\AlmaLinuxOS-9'; wsl --import AlmaLinuxOS-9 'C:\wsl\AlmaLinuxOS-9' .\install.tar.gz
   ```

1. 結果確認

   ```bash
   wsl -l -v
   ```

   ```
   NAME             STATE           VERSION
   * AlmaLinuxOS-9    Stopped         2
   ```

## AlmaLinux 9 の初期設定

1. PowerShell(ユーザ)を起動

1. WSL の起動

   ```bash
   wsl --distribution AlmaLinuxOS-9
   ```

1. ユーザ、パスワード、グループ設定

   ```bash
   adduser <USER>
   ```

   ```bash
   passwd <USER>
   ```

1. ユーザ切り替え

   ```bash
   su - <USER>
   ```

1. パッケージの更新とアップグレード

   ```bash
   dnf update -y && dnf upgrade -y
   ```

## /etc/wsl.conf の作成

下記２点の設定を行います。

- systemd の有効化
  - systemdtl コマンド利用時に必要
- デフォルトユーザの変更
  - WSL にログインした際のデフォルトユーザの変更

1. 事前に vim をいれておく

```bash
sudo dnf install y- vim
```

1. 設定ファイルの存在確認（ないことを確認）

```bash
ls -la /etc/wsl.conf
```

結果

```bash
ls: cannot access '/etc/wsl.conf': No such file or directory
```

1. vim で以下のように編集

```bash
[boot]
systemd=true

[user]
default=<USER>
```

1. WSL から切断し、PowerShell に戻って、WSL を再起動

```bash
exit
```

```PowerShell
wsl --terminate AlmaLinuxOS-9; wsl --distribution AlamalinuxOS-9
```
